# SIP Event Processor Configuration
# All values are externalized â€” nothing is hardcoded.

[general]
service_id = sip-proc-01
instance_name = sip_event_processor
log_level = info

[sip]
bind_url = sip:*:5060
user_agent = SIPEventProcessor/3.0
transport = udp

[dispatcher]
num_workers = 0                         # 0 = auto (hardware_concurrency)
max_incoming_queue_per_worker = 50000
max_dialogs_per_worker = 2000000

[tenant]
max_subscriptions_per_tenant = 5000

[reaper]
blf_subscription_ttl_sec = 3600
mwi_subscription_ttl_sec = 7200
scan_interval_sec = 60
stuck_processing_timeout_sec = 30

[presence]
# Comma-separated list of presence servers for failover
servers = 10.0.0.1:9000,10.0.0.2:9000,10.0.0.3:9000
reconnect_interval_sec = 5
reconnect_max_interval_sec = 60
read_timeout_sec = 30
recv_buffer_size = 65536
heartbeat_interval_sec = 15
heartbeat_miss_threshold = 3
max_pending_events = 100000
failover_strategy = round_robin         # round_robin | priority | random
health_check_interval_sec = 30
server_cooldown_sec = 120

[mongodb]
uri = mongodb://localhost:27017
database = sip_event_processor
collection_subscriptions = subscriptions
collection_blf_state = blf_state
pool_min_size = 2
pool_max_size = 10
write_concern = majority
read_preference = primaryPreferred
connect_timeout_ms = 5000
socket_timeout_ms = 10000
sync_interval_sec = 5
batch_size = 500
enable_persistence = true

[slow_event]
warn_threshold_ms = 50
error_threshold_ms = 200
critical_threshold_ms = 1000
log_stack_trace = false

[http]
enabled = true
bind_address = 0.0.0.0
port = 8080
read_timeout_sec = 30
write_timeout_sec = 30
max_connections = 100

[logging]
directory = /var/log/sip_processor
base_name = sip_processor
level = info
console_level = warn
max_file_size_mb = 50
max_rotated_files = 10
